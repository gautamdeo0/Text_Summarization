<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Text Translation and Summarization</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css"
    />
    <style>
      :root {
        --dark-bg: #1a1a1a;
        --darker-bg: #141414;
        --card-bg: #242424;
        --text-primary: #ffffff;
        --text-secondary: #b3b3b3;
        --accent-color: #3498db;
        --accent-hover: #2980b9;
        --border-color: #333333;
      }

      body {
        font-family: "Poppins", sans-serif;
        background: linear-gradient(135deg, #1a1a1a 0%, #141414 100%);
        min-height: 100vh;
        padding: 40px 20px;
        color: var(--text-primary);
      }

      .container {
        max-width: 900px;
        background-color: var(--card-bg);
        padding: 40px;
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      }

      .app-title {
        color: var(--text-primary);
        font-weight: 600;
        margin-bottom: 30px;
        text-align: center;
        font-size: 2.5rem;
      }

      .app-title i {
        color: var(--accent-color);
        margin-right: 10px;
      }

      .form-group {
        margin-bottom: 25px;
      }

      .form-label {
        font-weight: 500;
        color: var(--text-primary);
        margin-bottom: 10px;
      }

      .form-control {
        background-color: var(--dark-bg);
        border: 2px solid var(--border-color);
        border-radius: 12px;
        padding: 12px;
        transition: all 0.3s ease;
        color: var(--text-primary);
      }

      .form-control:focus {
        border-color: var(--accent-color);
        box-shadow: 0 0 0 0.2rem rgba(52, 152, 219, 0.25);
        background-color: var(--dark-bg);
        color: var(--text-primary);
      }

      .form-control::placeholder {
        color: var(--text-secondary);
      }

      #charCount {
        color: var(--text-secondary);
        font-size: 0.9em;
        float: right;
        margin-top: 5px;
      }

      .btn-primary {
        background: linear-gradient(
          135deg,
          var(--accent-color) 0%,
          var(--accent-hover) 100%
        );
        border: none;
        padding: 12px 30px;
        border-radius: 12px;
        font-weight: 500;
        letter-spacing: 0.5px;
        transition: all 0.3s ease;
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
      }

      .loading {
        display: none;
        margin: 30px 0;
        text-align: center;
        color: var(--text-primary);
      }

      .loading .spinner-border {
        width: 2rem;
        height: 2rem;
      }

      .error-message {
        color: #ff6b6b;
        background-color: rgba(231, 76, 60, 0.1);
        padding: 15px;
        border-radius: 12px;
        margin: 20px 0;
        display: none;
        font-weight: 500;
        border: 1px solid rgba(231, 76, 60, 0.2);
      }

      .result-section {
        background: var(--dark-bg);
        border-radius: 15px;
        padding: 25px;
        margin-top: 30px;
        border: 1px solid var(--border-color);
      }

      .rouge-scores {
        background: var(--card-bg);
        border-radius: 12px;
        padding: 15px;
        margin-top: 15px;
        border: 1px solid var(--border-color);
      }

      .rouge-score-item {
        display: flex;
        justify-content: space-between;
        margin-bottom: 8px;
        color: var(--text-primary);
      }

      .rouge-score-label {
        font-weight: 500;
      }

      .rouge-score-value {
        color: var(--accent-color);
      }

      .result-title {
        color: var(--text-primary);
        font-size: 1.3rem;
        font-weight: 600;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
      }

      .result-title i {
        margin-right: 10px;
        color: var(--accent-color);
      }

      .result-box {
        background-color: var(--card-bg);
        padding: 20px;
        border-radius: 12px;
        border: 1px solid var(--border-color);
        min-height: 60px;
        line-height: 1.6;
        color: var(--text-primary);
      }

      .copy-btn {
        float: right;
        padding: 5px 15px;
        font-size: 0.9em;
        border-radius: 8px;
        background-color: var(--dark-bg);
        border: 1px solid var(--border-color);
        color: var(--text-secondary);
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .copy-btn:hover {
        background-color: var(--border-color);
        color: var(--text-primary);
      }

      select.form-control {
        background-color: var(--dark-bg);
        color: var(--text-primary);
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%23ffffff' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M2 5l6 6 6-6'/%3e%3c/svg%3e");
        background-repeat: no-repeat;
        background-position: right 0.75rem center;
        background-size: 16px 12px;
      }

      select.form-control option {
        background-color: var(--dark-bg);
        color: var(--text-primary);
      }

      .char-count {
        color: var(--text-secondary);
        font-size: 0.9em;
        float: right;
        margin-top: 5px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1 class="app-title">
        <i class="bi bi-translate"></i>
        Text Translation & Summarization
      </h1>

      <div class="form-group">
        <label class="form-label" for="direction">
          <i class="bi bi-arrow-left-right"></i>
          Select Language Direction
        </label>
        <select class="form-control" id="direction">
          <option value="English to Hindi">English to Hindi</option>
          <option value="Hindi to English">Hindi to English</option>
          <option value="English to Kannada">English to Kannada</option>
          <option value="Kannada to English">Kannada to English</option>
        </select>
      </div>

      <div class="form-group">
        <label class="form-label" for="inputText">
          <i class="bi bi-pencil-square"></i>
          Input Text
        </label>
        <textarea
          class="form-control"
          id="inputText"
          rows="5"
          maxlength="5000"
          placeholder="Enter your text here..."
        ></textarea>
        <small id="charCount">0 / 5000 characters</small>
      </div>

      <button class="btn btn-primary w-100" onclick="processText()">
        <i class="bi bi-gear"></i>
        Process Text
      </button>

      <div class="loading">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
        <p class="mt-2">Processing your request... Please wait.</p>
      </div>

      <div class="error-message" id="errorMessage"></div>

      <div id="results" style="display: none">
        <div class="result-section">
          <div class="result-title">
            <i class="bi bi-translate"></i>
            Translation
            <button class="copy-btn" onclick="copyText('translationResult')">
              <i class="bi bi-clipboard"></i> Copy
            </button>
          </div>
          <div class="result-box" id="translationResult"></div>
          <small class="char-count" id="translationCount">0 characters</small>
        </div>

        <div class="result-section">
          <div class="result-title">
            <i class="bi bi-file-text"></i>
            Original Summary
            <button class="copy-btn" onclick="copyText('originalSummary')">
              <i class="bi bi-clipboard"></i> Copy
            </button>
          </div>
          <div class="result-box" id="originalSummary"></div>
          <small class="char-count" id="originalSummaryCount">0 characters</small>
        </div>

        <div class="result-section">
          <div class="result-title">
            <i class="bi bi-file-text"></i>
            Translated Summary
            <button class="copy-btn" onclick="copyText('translatedSummary')">
              <i class="bi bi-clipboard"></i> Copy
            </button>
          </div>
          <div class="result-box" id="translatedSummary"></div>
          <small class="char-count" id="translatedSummaryCount">0 characters</small>
          
          <div class="rouge-scores">
            <h5 class="result-title">
              <i class="bi bi-graph-up"></i>
              ROUGE Scores
            </h5>
            <div class="rouge-score-item">
              <span class="rouge-score-label">ROUGE-1:</span>
              <span class="rouge-score-value" id="rouge1Score">0.00</span>
            </div>
            <div class="rouge-score-item">
              <span class="rouge-score-label">ROUGE-2:</span>
              <span class="rouge-score-value" id="rouge2Score">0.00</span>
            </div>
            <div class="rouge-score-item">
              <span class="rouge-score-label">ROUGE-L:</span>
              <span class="rouge-score-value" id="rougeLScore">0.00</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      document
        .getElementById("inputText")
        .addEventListener("input", function () {
          const count = this.value.length;
          document.getElementById(
            "charCount"
          ).textContent = `${count} / 5000 characters`;
        });

      function copyText(elementId) {
        const text = document.getElementById(elementId).textContent;
        navigator.clipboard.writeText(text).then(() => {
          const btn = event.currentTarget;
          const originalText = btn.innerHTML;
          btn.innerHTML = '<i class="bi bi-check2"></i> Copied!';
          setTimeout(() => {
            btn.innerHTML = originalText;
          }, 2000);
        });
      }

      function processText() {
        const text = document.getElementById("inputText").value;
        const direction = document.getElementById("direction").value;

        if (!text.trim()) {
          showError("Please enter some text");
          return;
        }

        document.querySelector(".loading").style.display = "block";
        document.getElementById("results").style.display = "none";
        document.getElementById("errorMessage").style.display = "none";

        fetch("/process", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            text: text,
            direction: direction,
          }),
        })
          .then((response) => response.json())
          .then((data) => {
            document.querySelector(".loading").style.display = "none";

            if (data.error) {
              showError(data.error);
              return;
            }

            document.getElementById("results").style.display = "block";
            document.getElementById("translationResult").textContent =
              data.translation;
            document.getElementById("originalSummary").textContent =
              data.original_summary;
            document.getElementById("translatedSummary").textContent =
              data.translated_summary;

            // Update character counts
            document.getElementById("translationCount").textContent = 
              `${data.translation.length} characters`;
            document.getElementById("originalSummaryCount").textContent = 
              `${data.original_summary.length} characters`;
            document.getElementById("translatedSummaryCount").textContent = 
              `${data.translated_summary.length} characters`;

            // Update ROUGE scores
            if (data.rouge_scores) {
              document.getElementById("rouge1Score").textContent = 
                data.rouge_scores.rouge1.toFixed(3);
              document.getElementById("rouge2Score").textContent = 
                data.rouge_scores.rouge2.toFixed(3);
              document.getElementById("rougeLScore").textContent = 
                data.rouge_scores.rougeL.toFixed(3);
            }
          })
          .catch((error) => {
            document.querySelector(".loading").style.display = "none";
            showError("An error occurred while processing your request");
            console.error("Error:", error);
          });
      }

      function showError(message) {
        const errorDiv = document.getElementById("errorMessage");
        errorDiv.textContent = message;
        errorDiv.style.display = "block";
      }
    </script>
  </body>
</html>
